# Generated by Selenium IDE
import shelve
from time import sleep

from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.webdriver import ActionChains
from selenium.webdriver.common.action_chains import ActionChains


class TestDemo1:

    def setup_class(self):
        # option = Options()
        # option.debugger_address = 'localhost:9222'
        # self.driver = webdriver.Chrome(options=option)
        self.driver = webdriver.Chrome()
        self.driver.implicitly_wait(5)
        self.driver.maximize_window()
        self.action = ActionChains(self.driver)

    def teardown_class(self):
        # self.driver.quit()
        pass

    # def test_demo(self):
    #     self.driver.get("https://www.baidu.com/")
    #     self.driver.find_element_by_id("kw").send_keys("csdn")
    #     self.driver.find_element_by_id("su").click()
    #     self.driver.find_element_by_link_text("CSDN - 专业开发者社区").click()
        # self.driver.find_element_by_link_text("登录").click()
        # self.driver.get("https://keylol.com/member.php?mod=logging&action=login")
        # self.driver.find_element_by_id("cv_ricon_LX4hW").click()
        # myclass = self.driver.find_elements_by_css_selector(".wxlogin_tip").__getattribute__()
        # print(myclass)

    def test_getcookies(self):
        # cookies = self.driver.get_cookies()
        # print(cookies)
        cookies = [{'domain': '.csdn.net', 'httpOnly': False, 'name': 'Hm_lpvt_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '1597928873'}, {'domain': '.csdn.net', 'expiry': 1597932472, 'httpOnly': False, 'name': 'c_page_id', 'path': '/', 'secure': False, 'value': 'default'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_first_page', 'path': '/', 'secure': False, 'value': 'https%3A//blog.csdn.net/nancy125799972/article/details/51887169/'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_first_ref', 'path': '/', 'secure': False, 'value': 'www.baidu.com'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'dc_sid', 'path': '/', 'secure': False, 'value': '71356f43a5cf1a2225b2068900489f64'}, {'domain': '.csdn.net', 'expiry': 1912495852, 'httpOnly': False, 'name': 'log_Id_pv', 'path': '/', 'secure': False, 'value': '4'}, {'domain': '.csdn.net', 'expiry': 1599568207, 'httpOnly': False, 'name': 'searchHistoryArray', 'path': '/', 'secure': False, 'value': '%255B%2522python%2520%25E9%259D%25A2%25E5%2590%2591%25E5%25AF%25B9%25E8%25B1%25A1%2520%25E8%25B6%2585%25E8%25AF%25A6%25E7%25BB%2586%2522%255D'}, {'domain': '.csdn.net', 'expiry': 1628512174, 'httpOnly': False, 'name': 'UN', 'path': '/', 'secure': False, 'value': 'cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'AU', 'path': '/', 'secure': False, 'value': 'BF7'}, {'domain': '.csdn.net', 'expiry': 1629464872, 'httpOnly': False, 'name': 'Hm_up_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '%7B%22islogin%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isonline%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isvip%22%3A%7B%22value%22%3A%220%22%2C%22scope%22%3A1%7D%2C%22uid_%22%3A%7B%22value%22%3A%22cyberpunk2069%22%2C%22scope%22%3A1%7D%7D'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': True, 'name': 'UserToken', 'path': '/', 'secure': False, 'value': '568dd44f90744239b31dc9c5067abcc3'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'UserName', 'path': '/', 'secure': False, 'value': 'cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1627208467, 'httpOnly': False, 'name': 'Hm_lvt_8cfddb34ff818309d1644b2b4cad97d7', 'path': '/', 'secure': False, 'value': '1595672468'}, {'domain': '.csdn.net', 'expiry': 1598776664, 'httpOnly': False, 'name': 'announcement', 'path': '/', 'secure': False, 'value': '%257B%2522isLogin%2522%253Atrue%252C%2522announcementUrl%2522%253A%2522https%253A%252F%252Flive.csdn.net%252Froom%252Fyzkskaka%252Fats4dBdZ%253Futm_source%253D908346557%2522%252C%2522announcementCount%2522%253A0%257D'}, {'domain': 'www.csdn.net', 'httpOnly': False, 'name': 'TY_SESSION_ID', 'path': '/', 'secure': False, 'value': '01456601-60df-494a-b021-a26197b94685'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': True, 'name': 'UserInfo', 'path': '/', 'secure': False, 'value': '568dd44f90744239b31dc9c5067abcc3'}, {'domain': '.csdn.net', 'expiry': 1597943272, 'httpOnly': False, 'name': 'dc_tos', 'path': '/', 'secure': False, 'value': 'qfd5t4'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_ref', 'path': '/', 'secure': False, 'value': 'https%3A//blog.csdn.net/nancy125799972/article/details/51887169/'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'UserNick', 'path': '/', 'secure': False, 'value': 'cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1627208467, 'httpOnly': False, 'name': 'Hm_ct_8cfddb34ff818309d1644b2b4cad97d7', 'path': '/', 'secure': False, 'value': '5744*1*cyberpunk2069!6525*1*10_36631427180-1585212808507-747360'}, {'domain': '.csdn.net', 'expiry': 1629464872, 'httpOnly': False, 'name': 'Hm_lvt_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '1597926696,1597926772,1597927076,1597928703'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'p_uid', 'path': '/', 'secure': False, 'value': 'U000000'}, {'domain': '.csdn.net', 'expiry': 1648284809, 'httpOnly': False, 'name': '__gads', 'path': '/', 'secure': False, 'value': 'ID=117bb7e45fec36bd:T=1585212809:S=ALNI_Mbx_ysnoIDJt26yJuQ--md6AefA3A'}, {'domain': '.csdn.net', 'expiry': 1628512174, 'httpOnly': False, 'name': 'BT', 'path': '/', 'secure': False, 'value': '1596976170784'}, {'domain': '.csdn.net', 'expiry': 1627208467, 'httpOnly': False, 'name': 'Hm_up_8cfddb34ff818309d1644b2b4cad97d7', 'path': '/', 'secure': False, 'value': '%7B%22islogin%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isonline%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isvip%22%3A%7B%22value%22%3A%220%22%2C%22scope%22%3A1%7D%2C%22uid_%22%3A%7B%22value%22%3A%22cyberpunk2069%22%2C%22scope%22%3A1%7D%7D'}, {'domain': '.csdn.net', 'expiry': 1735689601, 'httpOnly': False, 'name': 'dc_session_id', 'path': '/', 'secure': False, 'value': '10_1585212808507.452259'}, {'domain': '.csdn.net', 'expiry': 1912495853, 'httpOnly': False, 'name': 'log_Id_view', 'path': '/', 'secure': False, 'value': '4'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_segment', 'path': '/', 'secure': False, 'value': '0'}, {'domain': '.csdn.net', 'expiry': 1912336229, 'httpOnly': False, 'name': 'log_Id_click', 'path': '/', 'secure': False, 'value': '2'}, {'domain': '.csdn.net', 'expiry': 1629464872, 'httpOnly': False, 'name': 'Hm_ct_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '6525*1*10_36631427180-1585212808507-747360!5744*1*cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1735689601, 'httpOnly': False, 'name': 'uuid_tt_dd', 'path': '/', 'secure': False, 'value': '10_36631427180-1585212808507-747360'}]
        self.driver.get("https://www.csdn.net/")

        for cookie in cookies:
            if 'expiry' in cookie.keys():
                cookie.pop('expiry')
            self.driver.add_cookie(cookie)

    def test_cookies(self):
        # shelve 小型数据，对象持久化保存方法
        # cookies = [{'domain': '.csdn.net', 'httpOnly': False, 'name': 'Hm_lpvt_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '1597928873'}, {'domain': '.csdn.net', 'expiry': 1597932472, 'httpOnly': False, 'name': 'c_page_id', 'path': '/', 'secure': False, 'value': 'default'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_first_page', 'path': '/', 'secure': False, 'value': 'https%3A//blog.csdn.net/nancy125799972/article/details/51887169/'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_first_ref', 'path': '/', 'secure': False, 'value': 'www.baidu.com'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'dc_sid', 'path': '/', 'secure': False, 'value': '71356f43a5cf1a2225b2068900489f64'}, {'domain': '.csdn.net', 'expiry': 1912495852, 'httpOnly': False, 'name': 'log_Id_pv', 'path': '/', 'secure': False, 'value': '4'}, {'domain': '.csdn.net', 'expiry': 1599568207, 'httpOnly': False, 'name': 'searchHistoryArray', 'path': '/', 'secure': False, 'value': '%255B%2522python%2520%25E9%259D%25A2%25E5%2590%2591%25E5%25AF%25B9%25E8%25B1%25A1%2520%25E8%25B6%2585%25E8%25AF%25A6%25E7%25BB%2586%2522%255D'}, {'domain': '.csdn.net', 'expiry': 1628512174, 'httpOnly': False, 'name': 'UN', 'path': '/', 'secure': False, 'value': 'cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'AU', 'path': '/', 'secure': False, 'value': 'BF7'}, {'domain': '.csdn.net', 'expiry': 1629464872, 'httpOnly': False, 'name': 'Hm_up_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '%7B%22islogin%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isonline%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isvip%22%3A%7B%22value%22%3A%220%22%2C%22scope%22%3A1%7D%2C%22uid_%22%3A%7B%22value%22%3A%22cyberpunk2069%22%2C%22scope%22%3A1%7D%7D'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': True, 'name': 'UserToken', 'path': '/', 'secure': False, 'value': '568dd44f90744239b31dc9c5067abcc3'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'UserName', 'path': '/', 'secure': False, 'value': 'cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1627208467, 'httpOnly': False, 'name': 'Hm_lvt_8cfddb34ff818309d1644b2b4cad97d7', 'path': '/', 'secure': False, 'value': '1595672468'}, {'domain': '.csdn.net', 'expiry': 1598776664, 'httpOnly': False, 'name': 'announcement', 'path': '/', 'secure': False, 'value': '%257B%2522isLogin%2522%253Atrue%252C%2522announcementUrl%2522%253A%2522https%253A%252F%252Flive.csdn.net%252Froom%252Fyzkskaka%252Fats4dBdZ%253Futm_source%253D908346557%2522%252C%2522announcementCount%2522%253A0%257D'}, {'domain': 'www.csdn.net', 'httpOnly': False, 'name': 'TY_SESSION_ID', 'path': '/', 'secure': False, 'value': '01456601-60df-494a-b021-a26197b94685'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': True, 'name': 'UserInfo', 'path': '/', 'secure': False, 'value': '568dd44f90744239b31dc9c5067abcc3'}, {'domain': '.csdn.net', 'expiry': 1597943272, 'httpOnly': False, 'name': 'dc_tos', 'path': '/', 'secure': False, 'value': 'qfd5t4'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_ref', 'path': '/', 'secure': False, 'value': 'https%3A//blog.csdn.net/nancy125799972/article/details/51887169/'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'UserNick', 'path': '/', 'secure': False, 'value': 'cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1627208467, 'httpOnly': False, 'name': 'Hm_ct_8cfddb34ff818309d1644b2b4cad97d7', 'path': '/', 'secure': False, 'value': '5744*1*cyberpunk2069!6525*1*10_36631427180-1585212808507-747360'}, {'domain': '.csdn.net', 'expiry': 1629464872, 'httpOnly': False, 'name': 'Hm_lvt_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '1597926696,1597926772,1597927076,1597928703'}, {'domain': '.csdn.net', 'expiry': 1612528174, 'httpOnly': False, 'name': 'p_uid', 'path': '/', 'secure': False, 'value': 'U000000'}, {'domain': '.csdn.net', 'expiry': 1648284809, 'httpOnly': False, 'name': '__gads', 'path': '/', 'secure': False, 'value': 'ID=117bb7e45fec36bd:T=1585212809:S=ALNI_Mbx_ysnoIDJt26yJuQ--md6AefA3A'}, {'domain': '.csdn.net', 'expiry': 1628512174, 'httpOnly': False, 'name': 'BT', 'path': '/', 'secure': False, 'value': '1596976170784'}, {'domain': '.csdn.net', 'expiry': 1627208467, 'httpOnly': False, 'name': 'Hm_up_8cfddb34ff818309d1644b2b4cad97d7', 'path': '/', 'secure': False, 'value': '%7B%22islogin%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isonline%22%3A%7B%22value%22%3A%221%22%2C%22scope%22%3A1%7D%2C%22isvip%22%3A%7B%22value%22%3A%220%22%2C%22scope%22%3A1%7D%2C%22uid_%22%3A%7B%22value%22%3A%22cyberpunk2069%22%2C%22scope%22%3A1%7D%7D'}, {'domain': '.csdn.net', 'expiry': 1735689601, 'httpOnly': False, 'name': 'dc_session_id', 'path': '/', 'secure': False, 'value': '10_1585212808507.452259'}, {'domain': '.csdn.net', 'expiry': 1912495853, 'httpOnly': False, 'name': 'log_Id_view', 'path': '/', 'secure': False, 'value': '4'}, {'domain': '.csdn.net', 'httpOnly': False, 'name': 'c_segment', 'path': '/', 'secure': False, 'value': '0'}, {'domain': '.csdn.net', 'expiry': 1912336229, 'httpOnly': False, 'name': 'log_Id_click', 'path': '/', 'secure': False, 'value': '2'}, {'domain': '.csdn.net', 'expiry': 1629464872, 'httpOnly': False, 'name': 'Hm_ct_6bcd52f51e9b3dce32bec4a3997715ac', 'path': '/', 'secure': False, 'value': '6525*1*10_36631427180-1585212808507-747360!5744*1*cyberpunk2069'}, {'domain': '.csdn.net', 'expiry': 1735689601, 'httpOnly': False, 'name': 'uuid_tt_dd', 'path': '/', 'secure': False, 'value': '10_36631427180-1585212808507-747360'}]
        db = shelve.open('mydb/logincookies')
        # db['cookie'] = cookies
        cookies = db['cookie']
        db.close()

        self.driver.get("https://www.csdn.net/")
        for cookie in cookies:
            if 'expiry' in cookie.keys():
                cookie.pop('expiry')
            self.driver.add_cookie(cookie)

        self.driver.get("https://www.csdn.net/")
        self.driver.find_element_by_css_selector('.userLogin:nth-child(6) .login_img').click()
        windows = self.driver.window_handles
        self.driver.switch_to.window(windows[-1])
        # 跳转当前页面

        self.driver.find_element_by_xpath('//*[@id="app"]/div/div/div[1]/ul[1]/li[8]/a').click()
        windows = self.driver.window_handles
        self.driver.switch_to.window(windows[-1])

        self.driver.find_element_by_xpath('//*[@id="app"]/div/div[1]/ul/li[2]/span').click()
        self.driver.find_element_by_xpath('//*[@id="csdn_container_tool"]/div/ul/li[6]/div[1]/a').click()
        windows = self.driver.window_handles
        self.driver.switch_to.window(windows[-1])

        img_position_element = self.driver.find_element_by_xpath('//*[@id="app"]/div/header/div/div/div[1]/div/img')
        self.action.move_to_element(img_position_element).click()
        # 鼠标悬浮点击：上传头像

        self.driver.find_element_by_xpath('//*[@id="app"]/div/header/div/div/div[1]/div/img').click()
        self.driver.find_element_by_xpath('//*[@id="app"]/div/header/div/div[2]/div/div/div[2]/div[1]/img').send_keys('D:\123.jpg')
        # self.driver.find_element_by_xpath('').click()
        print(windows)







